<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>VegaHub by panesofglass</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>VegaHub</h1>
          <h2>A SignalR Hub Utility for data scientists to push Vega charts from F# Interactive</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/panesofglass/VegaHub/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/panesofglass/VegaHub/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/panesofglass/VegaHub" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">
          <h1>
<a name="vegahub" class="anchor" href="#vegahub"><span class="octicon octicon-link"></span></a>VegaHub</h1>

<p>A SignalR Hub Utility for data scientists to push Vega charts from F# Interactive</p>

<h2>
<a name="current-status" class="anchor" href="#current-status"><span class="octicon octicon-link"></span></a>Current Status</h2>

<p>Proof-of-Concept</p>

<h3>
<a name="available-charts" class="anchor" href="#available-charts"><span class="octicon octicon-link"></span></a>Available charts</h3>

<ul>
<li><a href="https://github.com/panesofglass/VegaHub/blob/master/src/Vega.fs#L132">VegaHub.Templates.area</a></li>
<li><a href="https://github.com/panesofglass/VegaHub/blob/master/src/Vega.fs#L197">VegaHub.Templates.bar</a></li>
</ul><h2>
<a name="building" class="anchor" href="#building"><span class="octicon octicon-link"></span></a>Building</h2>

<p>VegaHub relies on several packages in the ASP.NET Web Stack nightly builds. You will need to add a reference to the MyGet feed in order to successfully build and run the script.</p>

<p>Add this to your NuGet package sources by going to Tools -&gt; Library Package Manager -&gt; Package Manager Settings and creating a new package source for <a href="http://www.myget.org/F/aspnetwebstacknightly">http://www.myget.org/F/aspnetwebstacknightly</a></p>

<p>Once you add this package source, you should build from the command line using build.bat in order to download NuGet.exe.</p>

<div class="highlight"><pre><span class="o">#</span><span class="n">load</span> <span class="s2">"WebApp.fs"</span>
<span class="o">#</span><span class="n">load</span> <span class="s2">"Vega.fs"</span>

<span class="k">open</span> <span class="nc">System</span>
<span class="k">open</span> <span class="nc">VegaHub</span>
<span class="k">open</span> <span class="nn">VegaHub</span><span class="p">.</span><span class="nc">Vega</span>

<span class="k">let</span> <span class="n">disposable</span> <span class="o">=</span> <span class="nn">WebApp</span><span class="p">.</span><span class="n">launch</span> <span class="s2">"http://localhost:8081"</span>

<span class="c1">// Simulate real-time updates</span>
<span class="k">let</span> <span class="n">rand</span> <span class="o">=</span> <span class="nc">Random</span><span class="o">(</span><span class="mi">42</span><span class="o">)</span>
<span class="c1">//let spec = Templates.bar</span>
<span class="k">let</span> <span class="n">spec</span> <span class="o">=</span> <span class="nn">Templates</span><span class="p">.</span><span class="n">area</span>
<span class="k">let</span> <span class="k">rec</span> <span class="n">loop</span> <span class="n">data</span> <span class="n">iter</span> <span class="o">=</span> <span class="n">async</span> <span class="o">{</span>
    <span class="k">let</span> <span class="n">data'</span> <span class="o">=</span> <span class="nn">Array</span><span class="p">.</span><span class="n">append</span> <span class="n">data</span> <span class="o">[|</span> <span class="nc">Point</span><span class="o">(</span><span class="nc">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="nc">Length</span><span class="o">,</span> <span class="nc">Y</span> <span class="o">=</span> <span class="n">rand</span><span class="o">.</span><span class="nc">Next</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">100</span><span class="o">))</span> <span class="o">|]</span>
    <span class="c1">// Warning: mutation!</span>
    <span class="n">spec</span><span class="o">.</span><span class="nc">Data</span> <span class="o">&lt;-</span> <span class="o">[|</span> <span class="nc">Data</span><span class="o">(</span><span class="nc">Name</span> <span class="o">=</span> <span class="s2">"table"</span><span class="o">,</span> <span class="nc">Values</span> <span class="o">=</span> <span class="n">data'</span><span class="o">)</span> <span class="o">|]</span>
    <span class="nn">Vega</span><span class="p">.</span><span class="n">send</span> <span class="n">spec</span>
    <span class="k">do</span><span class="o">!</span> <span class="nn">Async</span><span class="p">.</span><span class="nc">Sleep</span> <span class="mi">100</span>
    <span class="k">if</span> <span class="n">iter</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">then</span> <span class="bp">()</span> <span class="k">else</span>
    <span class="k">return</span><span class="o">!</span> <span class="n">loop</span> <span class="n">data'</span> <span class="o">&lt;|</span> <span class="n">iter</span> <span class="o">-</span> <span class="mi">1</span>
<span class="o">}</span>

<span class="n">loop</span> <span class="o">[||]</span> <span class="mi">25</span> <span class="o">|&gt;</span> <span class="nn">Async</span><span class="p">.</span><span class="nc">RunSynchronously</span>

<span class="n">disposable</span><span class="o">.</span><span class="nc">Dispose</span><span class="bp">()</span>
</pre></div>
        </section>

        <footer>
          VegaHub is maintained by <a href="https://github.com/panesofglass">panesofglass</a><br>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

        
      </div>
    </div>
  </body>
</html>
